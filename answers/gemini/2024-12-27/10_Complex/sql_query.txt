
SELECT c.first_name || ' ' || c.last_name AS customer_name, SUM(oi.quantity * oi.list_price * (1 - oi.discount)) AS total_purchase_amount, GROUP_CONCAT(p.product_name) AS products_purchased FROM customers c JOIN orders o ON c.customer_id = o.customer_id JOIN order_items oi ON o.order_id = oi.order_id JOIN products p ON oi.product_id = p.product_id GROUP BY customer_name ORDER BY total_purchase_amount DESC LIMIT 5;
